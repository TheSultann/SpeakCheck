Техническое Задание (ТЗ) на проект "SpeakCheck Telegram Bot"
Версия: 1.0
Дата: 24.05.2024
1. Общее описание проекта
Проект "SpeakCheck" — это Telegram-бот, разработанный на платформе Node.js. Бот выполняет две основные функции:
Ассистент по грамматике английского языка: Проверяет текстовые и голосовые сообщения пользователей на наличие грамматических, стилистических и пунктуационных ошибок, предлагая исправления и объяснения.
Тренажер для IELTS Speaking: Предоставляет интерактивную симуляцию устной части экзамена IELTS, позволяя пользователям практиковаться по реальным темам и вопросам.
2. Цели и задачи проекта
Основная цель: Создать удобный и доступный инструмент для пользователей, изучающих английский язык, для улучшения их письменных и устных навыков.
Задачи:
Реализовать функцию проверки грамматики с использованием AI-моделей (Google Gemini).
Интегрировать технологию распознавания речи (Google Cloud Speech-to-Text) для анализа голосовых сообщений.
Создать модульный и расширяемый тренажер для подготовки к IELTS Speaking.
Обеспечить стабильную работу бота и понятный пользовательский интерфейс в Telegram.
3. Целевая аудитория
Студенты, готовящиеся к сдаче экзамена IELTS.
Люди, изучающие английский язык на разных уровнях.
Пользователи, которым требуется быстрая проверка грамматики в повседневном общении.
4. Основной функционал
4.1. Функция проверки грамматики
Входные данные: Пользователь отправляет боту текстовое или голосовое сообщение (.ogg).
Процесс:
Для голосовых сообщений: аудиофайл преобразуется в текст с помощью Google Cloud Speech-to-Text API.
Полученный текст отправляется в языковую модель Google Gemini со специальным промптом для анализа.
Модель возвращает JSON-объект, содержащий полный исправленный текст и массив с детальными исправлениями (оригинальная фраза, исправленная фраза, объяснение).
Выходные данные:
Если ошибок нет, бот подтверждает корректность сообщения.
При наличии незначительных исправлений бот присылает исходный и улучшенный варианты.
При наличии существенных ошибок бот присылает улучшенный вариант и кнопку Show Corrections, по нажатию на которую выводится подробный список исправлений с объяснениями.
4.2. Тренажер IELTS Speaking
Инициация: Пользователь нажимает кнопку "IELTS Practice".
Процесс:
Бот предлагает выбрать часть экзамена (Part 1, 2, 3).
После выбора части бот предлагает выбрать тему из списка, загруженного из ieltsQuestions.js.
Бот последовательно задает вопросы по выбранной теме.
Пользователь отвечает текстом или голосом.
Каждый ответ пользователя обрабатывается функцией проверки грамматики (п. 4.1).
После анализа ответа бот задает следующий вопрос или завершает секцию.
Управление состоянием: Состояние практики (текущая часть, тема, номер вопроса) хранится в сессии пользователя (ctx.session.ieltsState).
5. Технический стек
Язык программирования: JavaScript (Node.js)
Фреймворк для бота: Telegraf.js
AI-модели:
Грамматика: Google Gemini (gemma-3-4b-it)
Распознавание речи: Google Cloud Speech-to-Text
Веб-сервер: Express.js (для health checks на хостинге)
Зависимости: dotenv, node-fetch, @google/generative-ai, @google-cloud/speech.
6. Структура проекта
bot.js: Главный файл. Инициализация бота, API, обработка всех входящих сообщений, маршрутизация логики между модулями.
IELTS/ieltsHandler.js: Модуль, инкапсулирующий всю логику, связанную с тренажером IELTS (управление клавиатурами, обработка ответов, навигация по вопросам).
IELTS/ieltsQuestions.js: Файл-хранилище данных. Содержит структуру вопросов для всех частей IELTS. Легко редактируется для добавления нового контента.
.env: Файл конфигурации для хранения секретных ключей и токенов.
package.json: Описание проекта и его зависимостей.
7. Описание ключевых компонентов и логики
checkGrammar(text): Асинхронная функция, которая формирует промпт для Gemini, отправляет запрос, парсит JSON-ответ и обрабатывает возможные ошибки (невалидный JSON, ошибки API).
recognizeSpeech(audioBuffer): Асинхронная функция, которая отправляет аудио-буфер в Google Speech-to-Text API и возвращает распознанный текст.
ieltsHandler: Модуль, который регистрирует свои обработчики (bot.action) в основном экземпляре Telegraf. Взаимодействует с bot.js через объект sharedFunctions (например, для вызова checkGrammar или отправки сообщений).
Сессии: Используется MemorySessionStore для хранения временных данных пользователя (состояние IELTS, ID исправлений). Внимание: для продакшена рекомендуется заменить на персистентное хранилище (например, Redis).
8. Конфигурация и запуск
Переменные окружения (.env):
TELEGRAM_BOT_TOKEN: Токен Telegram-бота.
GEMINI_API_KEY: Ключ API для Google Gemini.
GOOGLE_APPLICATION_CREDENTIALS: Путь к JSON-файлу с учетными данными сервисного аккаунта Google Cloud.
Установка зависимостей: npm install
Запуск: npm start
9. Направления для развития и новые функции
База данных и профили пользователей:
Заменить MemorySessionStore на Redis или базу данных (PostgreSQL, MongoDB) для сохранения сессий между перезапусками.
Создать профили пользователей для отслеживания прогресса, истории практик и частых грамматических ошибок.
Расширение контента:
Регулярно обновлять и добавлять новые темы и вопросы в ieltsQuestions.js.
Добавить другие режимы практики (например, TOEFL, деловой английский).
Улучшение анализа ответов:
Кроме грамматики, анализировать словарный запас (лексическое разнообразие), связность речи и давать рекомендации по их улучшению с помощью AI.
Для IELTS Part 2 добавить таймер на 1 минуту для подготовки и 2 минуты для ответа.
Административная панель:
Создать простой веб-интерфейс для управления контентом (добавления вопросов) и просмотра статистики использования бота.
Монетизация:
Введение премиум-подписки для доступа к расширенному контенту, более глубокому анализу ответов или снятию дневных лимитов на использование.